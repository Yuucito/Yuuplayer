<!DOCTYPE html>
<html lang="es">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Reproductor Embebido</title>
    <link href="https://cdn.jsdelivr.net/npm/artplayer@latest/dist/artplayer.css" rel="stylesheet">
    <style>
        body {
            margin: 0;
            padding: 0;
            background: #000;
        }
        #player {
            width: 100%;
            height: 100vh;
        }
    </style>
</head>
<body>
    <div id="player"></div>

    <!-- Scripts -->
    <script src="https://cdn.jsdelivr.net/npm/artplayer@latest/dist/artplayer.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/hls.js@latest"></script>
    <script src="https://cdn.jsdelivr.net/npm/artplayer-plugin-hls@latest/dist/artplayer-plugin-hls.js"></script>
    <script src="https://imasdk.googleapis.com/js/sdkloader/ima3.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/artplayer-plugin-vast@latest/dist/artplayer-plugin-vast.js"></script>
    
    <script>
        // URL VAST fija
        const VAST_URL = "https://pubads.g.doubleclick.net/gampad/ads?iu=/21775744923/external/single_ad_samples&sz=640x480&cust_params=sample_ct%3Dlinear&ciu_szs=300x250%2C728x90&gdfp_req=1&output=vast&unviewed_position_start=1&env=vp&impl=s&correlator=";
        
        // Obtener parámetros de URL
        const urlParams = new URLSearchParams(window.location.search);
        const streamUrl = urlParams.get('stream');
        
        // Inicializar reproductor
        if (streamUrl) {
            const art = new Artplayer({
                container: '#player',
                url: decodeURIComponent(streamUrl),
                autoplay: true,
                fullscreen: true,
                fullscreenWeb: true,
                plugins: [
                    artplayerPluginHls,
                    artplayerPluginVast(({ playUrl }) => {
                        art.once('play', () => {
                            playUrl(VAST_URL);
                        });
                    }),
                ],
            });
            
            art.on('vast:error', (error) => {
                console.error('Error en VAST:', error);
                art.play();
            });
        } else {
            document.getElementById('player').innerHTML = '<p style="color: white; text-align: center; padding: 50px;">No se proporcionó URL de stream. Ejemplo de uso: player.html?stream=URL_DEL_STREAM</p>';
        }
    </script>
</body>
</html>
